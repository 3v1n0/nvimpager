#!/bin/sh

# If we are not on a tty just "be" cat.
if [ ! -t 1 ]; then
  exec cat "$@"
fi

RUNTIME=${0%/*}
export RUNTIME
# TODO see what option less provides

if [ $# -eq 0 -o ! -t 0 ]; then
  set -- "$@" -
fi

rc=~/.config/nvim/pagerrc.vim
if [ ! -r "$rc" ]; then
  rc=NORC
fi

nvim \
  -u "$rc" \
  --cmd 'set rtp^=$RUNTIME' \
  --cmd 'call pager#start()' \
  -c 'call pager#start2()' \
  "$@"
